<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CpuStatus - Preview</title>
    <script src="https://cdn.jsdelivr.net/npm/echarts@5.4.3/dist/echarts.min.js"></script>
    <style>
        /* === component.css (inline) === */
        #cpu-status-container {
            width: 488px;
            height: 187px;
            overflow: auto;

            & .cpu-status {
                width: 100%;
                height: 100%;
                background: rgba(42, 42, 42, 0.5);
                border: 0.3px solid #778985;
                border-radius: 16px;
                padding: 14px 24px 20px 24px;
                display: flex;
                flex-direction: column;
                gap: 22px;
                position: relative;
                font-family: 'Pretendard', sans-serif;
            }
            & .group {
                display: flex;
                flex-direction: column;
                align-items: center;
                justify-content: center;
                width: 100%;
            }
            & .header {
                display: flex;
                height: 38px;
                align-items: center;
                justify-content: space-between;
                width: 100%;
            }
            & .title {
                display: flex;
                gap: 9px;
                align-items: center;
            }
            & .icon {
                width: 16.681px;
                height: 18.27px;
                & img { width: 100%; height: 100%; display: block; }
            }
            & .title-text {
                font-size: 18px;
                font-weight: 600;
                color: #e9ebeb;
                white-space: nowrap;
            }
            & .container {
                display: flex;
                flex-direction: column;
                align-items: center;
                justify-content: flex-end;
                width: 100%;
            }
            & .contents {
                display: flex;
                gap: 9px;
                align-items: flex-start;
                width: 100%;
            }
            & .chart-item {
                flex: 1 1 0;
                min-width: 1px;
                min-height: 1px;
                height: 93px;
                display: flex;
                flex-direction: column;
                align-items: center;
                justify-content: space-between;
            }
            & .chart-container {
                width: 60px;
                height: 60px;
            }
            & .item-label {
                padding: 6px 0;
                border-radius: 4.714px;
                display: flex;
                flex-direction: column;
                align-items: center;
                justify-content: center;
                overflow: hidden;
                min-width: 60px;
                & p { font-size: 13px; font-weight: 600; white-space: nowrap; }
            }
            & .item-label-cyan {
                border: 1px solid rgba(0, 205, 237, 0.5);
                & p { color: #00cded; }
            }
            & .item-label-yellow {
                border: 1px solid rgba(255, 210, 31, 0.5);
                & p { color: #ffd21f; }
            }
            & .item-label-orange {
                border: 1px solid rgba(255, 158, 0, 0.5);
                & p { color: #ff9e00; }
            }
            & .item-label-red {
                border: 1px solid rgba(255, 34, 0, 0.5);
                & p { color: #ff2200; }
            }
            & .inset-shadow {
                position: absolute;
                inset: 0;
                pointer-events: none;
                box-shadow: inset 4px 4px 4px 0px rgba(0, 0, 0, 0.06);
                border-radius: 16px;
            }
        }

        /* === preview-specific === */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            background-color: #1a1a1a;
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            font-family: 'Pretendard', sans-serif;
        }
    </style>
</head>
<body>
    <div id="cpu-status-container">
        <div class="cpu-status">
            <!-- Header -->
            <div class="group">
                <div class="header">
                    <div class="title">
                        <div class="icon">
                            <img src="assets/6e134c6c4f175a81f94018216584fd808a1b84b6.svg" alt="">
                        </div>
                        <p class="title-text">주요 업무 그룹 CPU 현황</p>
                    </div>
                </div>
            </div>

            <!-- Container -->
            <div class="container">
                <div class="contents">
                    <!-- Charts rendered by JavaScript -->
                </div>
            </div>

            <!-- Inset shadow overlay -->
            <div class="inset-shadow"></div>
        </div>
    </div>

    <script>
        // Mock data for preview
        const mockData = {
            items: [
                { name: '상품', value: 24, color: '#E3B500', labelColor: 'cyan' },
                { name: '디지털업무', value: 20, color: '#00A9AE', labelColor: 'yellow' },
                { name: 'EBK', value: 18, color: '#00A9AE', labelColor: 'cyan' },
                { name: '채널EIC', value: 2, color: '#DF7200', labelColor: 'orange' },
                { name: '대내EIC', value: 5, color: '#00A9AE', labelColor: 'cyan' },
                { name: '대외EIC', value: 8, color: '#BE1813', labelColor: 'red' }
            ]
        };

        // Chart configuration
        const chartConfig = {
            trackColor: '#22302B',
            radius: ['75%', '90%'],
            labelFontSize: 14,
            labelFontWeight: 700
        };

        // Create pie chart option
        function createPieOption(item, config) {
            return {
                series: [{
                    type: 'pie',
                    radius: config.radius,
                    center: ['50%', '50%'],
                    startAngle: 90,
                    silent: true,
                    data: [
                        {
                            value: item.value,
                            itemStyle: { color: item.color }
                        },
                        {
                            value: 100 - item.value,
                            itemStyle: { color: config.trackColor }
                        }
                    ],
                    label: { show: false },
                    labelLine: { show: false }
                }],
                graphic: {
                    type: 'text',
                    left: 'center',
                    top: 'center',
                    style: {
                        text: `${item.value}%`,
                        fill: '#ffffff',
                        fontSize: config.labelFontSize,
                        fontWeight: config.labelFontWeight,
                        fontFamily: 'Pretendard',
                        textAlign: 'center',
                        textVerticalAlign: 'middle'
                    }
                }
            };
        }

        // Render charts
        function renderCharts(data) {
            const contentsEl = document.querySelector('.contents');
            if (!contentsEl) return;

            data.items.forEach((item, index) => {
                // Create chart item structure
                const chartItem = document.createElement('div');
                chartItem.className = 'chart-item';
                chartItem.dataset.index = index;
                chartItem.dataset.name = item.name;

                // Chart container
                const chartContainer = document.createElement('div');
                chartContainer.className = 'chart-container';
                chartContainer.id = `cpu-chart-${index}`;

                // Label
                const label = document.createElement('div');
                label.className = `item-label item-label-${item.labelColor}`;
                label.innerHTML = `<p>${item.name}</p>`;

                chartItem.appendChild(chartContainer);
                chartItem.appendChild(label);
                contentsEl.appendChild(chartItem);

                // Initialize ECharts
                const chart = echarts.init(chartContainer);
                chart.setOption(createPieOption(item, chartConfig));
            });
        }

        // Initialize on DOM ready
        document.addEventListener('DOMContentLoaded', () => {
            renderCharts(mockData);
        });
    </script>
</body>
</html>
